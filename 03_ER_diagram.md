# 1個目のER図

## 全体
- それぞれのテーブルに登録日、更新日の項目が記述されていませんでした。ActiveRecordでデフォルトで作られる登録日、更新日の記述もお願いいたします。もし持たないのであれば理由を教えてください。

## 購入履歴
- 購入履歴テーブルのPKが記述されていません。
 PKはあくまでもレコードを一意に判別するためのキーです。現状では購入履歴を一意に判別出来ません。
- [check]購入ステータスがありますが、このテーブルで適切でしょうか。
  一つの注文で購入ステータスは同じになるはずなので、商品ごとに設ける必要はありません。
  決済テーブルを受注テーブルとし、一度の注文に関する情報として集約させることができます。
- [add]注文した商品が何なのか、現状では確認ができません。
  どのようなエンティティのあり方が適切か考え、そこに誘導できるようなレビュー文を返しましょう。
  (なお、文章で伝えきれない部分については、あとでチームのデスクにお邪魔して解説するのもアリですし、むしろ推奨しています。)
  
## 決算
- [check]テーブル名は「決済」です。
- **[check]下記にもう一つ、このテーブルに関する見出しがあります。どちらか一つに統一しましょう。**
-カートテーブルと決算テーブル間にリレーションがありますが、FKが見当たりません。
 適切にFKが設定されていないので、これでは購入時の合計金額を算出する事が出来ません。

## エンドユーザー
- PKにユーザーIDとの記載がありますがテーブル名はエンドユーザーです。PKはあくまでもレコードを一意に判別するためのキーです。PKはテーブル名+IDとの形にしましょう。
- エンドユーザが退会した場合、該当のレコードはどうなりますか。

## 配送先
- ユーザの登録住所以外にも、配送先を指定したい場合はどうなりますか。毎回手入力を行うのでしょうか。配送先を複数持てるようにしてほしいです。(amazonのような形式が理想です）

## 商品
- 曲カラムがありますが、同一カラムに複数の曲名を入れるということでしょうか。
* 1曲だけ曲名を変更したい・1曲だけ削除したい、など、後からデータを変更する際に不便になります。
* 複数ディスク、曲順などの管理も難しくなります。
* ユーザー側に表示するときにデザインも当てづらくなります。
カリキュラム「チーム開発の手引き」＞「設計」＞データベース設計スライドの29枚目以降を再確認してください。

-発売日はどのように管理しますか。
- 在庫数カラムがありますが、商品が入荷するたびに数値を変更するのでしょうか。
* 例えば現在の在庫が100個あって、入荷が350個あった場合、在庫数を450と入力する運用だとすると計算ミスを誘発しやすく、実際の在庫数とデータベース上の在庫数に差が生まれやすい構造となります。入荷したタイミングで入荷数を入れられるようにすれば楽です。
* 運営上、「いつ、どの商品が入荷したか」という情報を管理しておく方が安全な運用です。入荷数の証拠にもなります。

- [add]下記3点について、レビュー文で問題提起が必要です。
  - アーティスト名、レーベル名、ジャンル名を直接入力させる構造は適切でしょうか。
  - 複数枚ディスクの登録がある場合、このテーブル構造だと対応できません。
  - ステータス(取り扱い)は、具体的に何のステータスを示しているか一見しただけで分かりません。

## カートテーブル
- PKに注文IDとの記載がありますがテーブル名はカートです。PKはあくまでもレコードを一意に判別するためのキーです。PKはテーブル名+IDとの形にしましょう。
- カート内の商品は顧客ごとに異なりますが、どのように判断しますか。
- カートテーブルという命名ですが、表現されているのは「カートの中身」かと思います。カートは一つ、その中に入っている商品は複数、というイメージかと思いますので、テーブル名を「カートアイテム」「カート内商品」のような命名にすると良いかと思います。
-- 商品の価格が変更された場合、このテーブルのデータはどうなりますか。
- [add]アーティスト名、ジャケット画像、シングル/アルバム名のカラムは不要です。不要な理由を考え、レビュー文に追記してください。

## 決算
- [check]テーブル名は「決済」です。
- **[check]上記にもう一つ、このテーブルに関する見出しがあります。どちらか一つに統一しましょう。**
- テーブル名は、「受注」「注文」のような命名にしましょう。
  - データベースの情報は管理者が利用します。管理者側のアクションにしましょう。
- 1会計で何を買ったか判断できますか？（同梱の判断ができるか）
- 合計金額を保存しているカラムがありません。注文明細のデータを計算すれば算出できる値ですが、証跡として計算結果を残しておくことが多いです（計算できる値は原則DBに持ちませんが、お金のことは細心の注意が必要です）。「顧客に請求した金額と、その内訳を店側で説明できるようにしておく」必要があります。
-どこのテーブルにも送料の情報が保存されていないので、購入時の送料を確認する事が出来ません。
- [add]購入日カラムがありますが、他のカラムで代替可能なので、必須ではありません、どのカラムで代替可能か考え、レビュー文に追記してください。
- [add]住所カラムが存在しますが、発送先の情報としてこれだけで十分ではありません。問題提起をレビュー文に追記してください。
- [add]カートidをFKとして持っていますが、必要ありません。

## 購入履歴
- 購入後に値下げが起こった場合、購入時の価格は確認できますか。
- 何を購入したか判別できますか。
- [add]ステータス(発送状況)は、購入した商品ごとではなく、注文の属性として持つべきものです。レビュー文に追記してください。

## 入荷
- 要件に「入荷履歴を表示できること（入荷した日時、入荷した商品、個数）」がありますが、どのように実現しますか。

## お問い合わせ
- 店が返信した内容は保持できますか。

## 管理者
- 管理者テーブルとエンドユーザーテーブル、管理者テーブルと商品テーブルにリレーションがありますが、理由はありますか。

# 二個目のER図
##管理者
- 管理者テーブルとエンドユーザーテーブル,管理者テーブルと商品テーブルにリレーションがありますが、理由はありますか。
-PKの記述がありません。カートテーブルを一意に判別したい場合にはどうしますか。

## カートアイテムテーブル
- **[check]カートアイテムテーブルに関する指摘が二箇所に存在します。どちらかに統一しましょう。**
-PKの記述がありませんでした。カートテーブルを一意に判別したい場合にはどうしますか。

## エンドユーザー
-漢字で入力された名前はどこに保存されるのでしょうか。
-エンドユーザーが退会した場合は,該当のレコードはどうなりますか。
-エンドユーザーテーブルには住所カラムとは別に配送先カラムがあります。二つの住所しか登録できないのでしょうか。
- [add]PKがユーザーIDとなっており、テーブル名と乖離しています。レビュー文に追記してください。

## 配送先テーブル
-ユーザの登録住所以外にも,配送先を複数持てるようにしてほしいです。(amazonのような形式が理想です)

## 商品
-販売日はどのように管理しますか。
-在庫数カラムがありますが、商品が入荷するたびに数値を変更するのでしょうか。
* 例えば現在の在庫が100個あって,入荷が350個あった場合,在庫数を450と入力する運用だとすると計算ミスを誘発しやすく,実際の在庫数とデータベース上の在庫数に差が生まれやすい構造となります。
入荷したタイミングで入荷数を入れられるようにすれば楽です。
* 運営上「いつ,どの商品が入荷したか」という情報を管理しておく方が安全な運用です。
 - 入荷数の証拠にもなります。
- [add]ディスク枚数が存在しますが、ディスクテーブルのデータから算出できるため不要です。 レビュー文に追記してください。

## ディスクテーブル
- 複数枚組のCDは登録出来ますか？
(1枚目の1曲目と2枚目の1曲目の区別はつけられますか？)
 - [delete]ディスクテーブルが存在しているので、複数枚組の考慮はできています。したがって、この指摘は不要です。
- [add] 商品とディスクのリレーションが逆になっています。
  この場合、「商品に対するカーディナリティについて、ディスク1枚に対して複数商品が存在するような書き方となっておりますが、想定通りですか？」と問題提起すると良いでしょう。
- [add]トラックNoとありますが、これはディスク内での曲順を表す番号ですので、持たせるテーブルが異なります。どのテーブルに持たせれば良いか考え、レビュー文を追記してください。

## 曲
--曲名はどちらに保存する予定でしょうか。
  - [delete]「シングルアルバム内の曲名」というカラムがそれに相当するかと思いますので、指摘不要です。
- [add] ディスクと曲のリレーションが逆になっています。ディスクと商品のリレーションの時と同様のレビュー文を追記してください。


## カートアイテム
- **[check]カートアイテムテーブルに関する指摘が二箇所に存在します。どちらかに統一しましょう。**
-カートアイテムテーブルがカート内の商品を確認するテーブルなのでしょうか。
-FKに商品IDとの記述がありますが、一商品しか登録出来ないのでしょうか。複数の商品をカートにいれることが想定出来ますが、その場合にカート内商品はどのように保存する予定でしょうか。
-小計金額カラムはカート内にいれられている商品の値段の合計でしょうか。

## 購入
- テーブル名は、「受注」「注文」のような命名にしましょう。
    - データベースの情報は管理者が利用します。管理者側のアクションにしておきましょう。
-送料が変更された場合,購入時の送料はいくらだったか確認できますか。
  - [delete]送料カラムがあるので、こちらで確認ができます。したがって、この指摘は不要です。
-購入日カラムが記述されていたのですが、created_atと同日になると思います。別で盛った理由はありますか。(間違いではないので、理由があれば知りたいです)
  - [check] 盛った→持った
  - [add] 配送状況が確認できません。どのように確認できるようにするか問題提起し、レビュー文に追加してください。

## 購入詳細
- 何を購入したか判別できますか。
- [add] 購入：購入詳細のリレーションが逆です。ディスクと商品のリレーションの時と同様のレビュー文を追記してください。
- [add] テーブル名は「購入」同様、「受注詳細」「注文詳細」のような命名にする必要があります。

## 入荷テーブル
-要件に「入荷履歴を表示できること（入荷した日時、入荷した商品、個数）」がありますが、どのように実現しますか。

## 問い合わせ
- 店側が返信した内容は保持できますか。

## ジャンル・レーベル(add)
- ジャンル・レーベルというカラム名は、「ジャンル名」「レーベル名」とするのが適切です。
  ジャンルの属性が「ジャンル」、レーベルの属性が「レーベル」というのは、全く同じことを指しているので属性の説明になっていません。

# 二個目のER図
(重複していたのでここから下は削除しました。)
